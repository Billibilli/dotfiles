# Based on http://www.bartbania.com/index.php/consolify-your-gmail-with-mutt/
# and on http://lifehacker.com/5574557/how-to-use-the-fast-and-powerful-mutt-email-client-with-gmail

# set locale = "en_US.UTF-8"
source ~/Dropbox/sec/auth
source dark.256.muttrc.erb

# Account details
set imap_user = $my_adress
set imap_pass = $my_pass
set from = $my_adress
set realname = $my_realname
set smtp_url = $my_smtp_url
set smtp_pass = $my_pass

# Remote Gmail folders
set folder = $my_folder
set spoolfile = "+INBOX"
set postponed ="+[Google Mail]/Drafts"
set record = "+[GMail]/Sent Mail"
# set trash = "+[Google Mail]/Trash"
# set any_label = "+[Google Mail]/any_label"

# Local folders for cached headers and certificates
set header_cache ="~/.mutt/cache/headers"
set message_cachedir ="~/.mutt/cache/bodies"
set certificate_file ="~/.mutt/certificates"

# Fixes the 'No authenticators available' error
set smtp_authenticators = 'gssapi:login'

# Securing
set move = no
set imap_keepalive = 900

unset markers # Don't display ugly plus signs when wrapping lines
set pager_index_lines=10 # Keep index visible when opening mail (split view)
set smart_wrap # Be smart when wrapping lines
set pager_stop

auto_view text/html # view html automatically
alternative_order text/plain text/enriched text/html # save html for last

# Email check
set timeout=10     # mutt 'presses' (like) a key for you (while you're idle) 
                   # each x sec to trigger the thing below
set mail_check=120 # mutt checks for new mails on every keystroke
                   # but not more often then once in 120 seconds
set beep_new       # beep on new messages in the mailboxes

# Use goobook to search contacts
set query_command="goobook query '%s'"

# Gmail-style threading
set sort = 'threads'
set sort_aux = 'reverse-last-date-received'

set include
set fast_reply

# Key bindings
bind generic,index Q exit
bind editor <space> noop
bind editor <Tab> complete-query

bind browser gg  top-page
bind browser G   bottom-page
bind browser \Cb previous-page
bind browser \Cf next-page
bind browser A   check-new
bind browser v   view-file

bind index ~   set-flag
bind index \Cv what-key
bind index H   current-top
bind index M   current-middle
bind index L   current-bottom
bind index /   search
bind index :   enter-command
bind index i   mail

bind pager i   edit
bind pager u   mark-as-new
bind pager gg  top
bind pager G   bottom
bind pager j   next-line
bind pager k   previous-line

bind index,attach gg  first-entry
bind index,attach G   last-entry

bind index,pager L   list-reply
# bind index,pager P   print-message
bind index,pager R   group-reply
bind index,pager \Cd half-down
bind index,pager \Cu half-up
bind index,pager \Cf next-page
bind index,pager \Cb previous-page
bind index,pager \Cn next-thread
bind index,pager \Cp previous-thread

bind index,pager f forward-message
bind index,pager p previous-undeleted
bind index,pager N next-unread
bind index,pager P previous-unread

bind index,pager X print-message

# Gmail-style keyboard shortcuts
macro index,pager y "<enter-command>unset trash\n <delete-message>" "Gmail archive message"
macro index,pager d "<enter-command>set trash=\"imaps://imap.googlemail.com/[GMail]/Bin\"\n <delete-message>" "Gmail delete message"
macro index,pager gi "<change-folder>=INBOX<enter>" "Go to inbox"
macro index,pager ga "<change-folder>=[Gmail]/All Mail<enter>" "Go to all mail"
macro index,pager gs "<change-folder>=[Gmail]/Starred<enter>" "Go to starred messages"
macro index,pager gd "<change-folder>=[Gmail]/Drafts<enter>" "Go to drafts"

# Not sure I need these
# set imap_check_subscribed
# set hostname = gmail.com
# set auto_tag = yes
# ignore "Authentication-Results:"
# ignore "DomainKey-Signature:"
# ignore "DKIM-Signature:"
# hdr_order Date From To Cc
# alternative_order text/plain text/html *
# auto_view text/html


